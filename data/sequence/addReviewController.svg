<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1542px" preserveAspectRatio="none" style="width:2137px;height:1542px;background:#FFFFFF;" version="1.1" viewBox="0 0 2137 1542" width="2137px" zoomAndPan="magnify"><defs><filter height="300%" id="f1owc7gk2nf7t9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="1525.8125" style="stroke:#000000;stroke-width:1.0;" width="2120.5" x="5" y="5"/><path d="M176,5 L176,15.6094 L166,25.6094 L5,25.6094 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="17" x="8" y="20.5332">sd</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="29" y="20.5332">Add Review Controller</text><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="1320.2422" style="stroke:#A80036;stroke-width:1.0;" width="10" x="180.5" y="149.5703"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="1289.8906" style="stroke:#A80036;stroke-width:1.0;" width="10" x="382.5" y="179.9219"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="966.8906" style="stroke:#A80036;stroke-width:1.0;" width="10" x="742.5" y="472.5703"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="117.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1132.5" y="253.625"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="91.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1591.5" y="502.9219"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="91.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1683" y="769.5703"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="91.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1778" y="992.8672"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="91.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1881" y="1216.1641"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="2027" y="799.9219"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="2027" y="1023.2188"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="2027" y="1246.5156"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="1120.1328" style="stroke:#000000;stroke-width:2.0;" width="2010.5" x="101" y="385.6797"/><rect fill="#FFFFFF" height="1071.4297" style="stroke:none;stroke-width:1.0;" width="2010.5" x="101" y="434.3828"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="889.8359" style="stroke:#000000;stroke-width:2.0;" width="1990.5" x="111" y="608.9766"/><rect fill="#FFFFFF" height="810.7813" style="stroke:none;stroke-width:1.0;" width="1990.5" x="111" y="688.0313"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="616.1875" style="stroke:#000000;stroke-width:2.0;" width="1970.5" x="121" y="875.625"/><rect fill="#FFFFFF" height="537.1328" style="stroke:none;stroke-width:1.0;" width="1970.5" x="121" y="954.6797"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="385.8906" style="stroke:#000000;stroke-width:2.0;" width="1950.5" x="131" y="1098.9219"/><rect fill="#FFFFFF" height="306.8359" style="stroke:none;stroke-width:1.0;" width="1950.5" x="131" y="1177.9766"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="155.5938" style="stroke:#000000;stroke-width:2.0;" width="693.5" x="141" y="1322.2188"/><rect fill="#FFFFFF" height="76.5391" style="stroke:none;stroke-width:1.0;" width="693.5" x="141" y="1401.2734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="27" x2="27" y1="117.2188" y2="1522.8125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="185" x2="185" y1="117.2188" y2="1522.8125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="387" x2="387" y1="117.2188" y2="1522.8125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="747.5" x2="747.5" y1="117.2188" y2="1522.8125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1137" x2="1137" y1="117.2188" y2="1522.8125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1596.5" x2="1596.5" y1="117.2188" y2="1522.8125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1687.5" x2="1687.5" y1="117.2188" y2="1522.8125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1782.5" x2="1782.5" y1="117.2188" y2="1522.8125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1885.5" x2="1885.5" y1="117.2188" y2="1522.8125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="2031.5" x2="2031.5" y1="117.2188" y2="1522.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="10" y="114.1426">User</text><ellipse cx="27.5" cy="42.6094" fill="#FEFECE" filter="url(#f1owc7gk2nf7t9)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M27.5,50.6094 L27.5,77.6094 M14.5,58.6094 L40.5,58.6094 M27.5,77.6094 L14.5,92.6094 M27.5,77.6094 L40.5,92.6094 " fill="none" filter="url(#f1owc7gk2nf7t9)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1owc7gk2nf7t9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="65" x="151" y="80.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="158" y="102.1426">Browser</text><rect fill="#FEFECE" filter="url(#f1owc7gk2nf7t9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="107" x="332" y="80.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="339" y="102.1426">CustomerFilter</text><rect fill="#FEFECE" filter="url(#f1owc7gk2nf7t9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="150" x="670.5" y="80.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="677.5" y="102.1426">:AddReviewController</text><rect fill="#FEFECE" filter="url(#f1owc7gk2nf7t9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="55" x="1108" y="80.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="1115" y="102.1426">Helper</text><rect fill="#FEFECE" filter="url(#f1owc7gk2nf7t9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="78" x="1555.5" y="80.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="1562.5" y="102.1426">GetParam</text><rect fill="#FEFECE" filter="url(#f1owc7gk2nf7t9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="77" x="1647.5" y="80.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="1654.5" y="102.1426">:UserDAO</text><rect fill="#FEFECE" filter="url(#f1owc7gk2nf7t9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="85" x="1738.5" y="80.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="1745.5" y="102.1426">:RoomDAO</text><rect fill="#FEFECE" filter="url(#f1owc7gk2nf7t9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="93" x="1837.5" y="80.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="1844.5" y="102.1426">:ReviewDAO</text><rect fill="#FEFECE" filter="url(#f1owc7gk2nf7t9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="75" x="1992.5" y="80.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1999.5" y="102.1426">Database</text><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="1320.2422" style="stroke:#A80036;stroke-width:1.0;" width="10" x="180.5" y="149.5703"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="1289.8906" style="stroke:#A80036;stroke-width:1.0;" width="10" x="382.5" y="179.9219"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="966.8906" style="stroke:#A80036;stroke-width:1.0;" width="10" x="742.5" y="472.5703"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="117.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1132.5" y="253.625"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="91.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1591.5" y="502.9219"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="91.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1683" y="769.5703"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="91.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1778" y="992.8672"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="91.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1881" y="1216.1641"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="2027" y="799.9219"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="2027" y="1023.2188"/><rect fill="#FFFFFF" filter="url(#f1owc7gk2nf7t9)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="2027" y="1246.5156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="178.5" x2="168.5" y1="149.5703" y2="145.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="178.5" x2="168.5" y1="149.5703" y2="153.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="27.5" x2="179.5" y1="149.5703" y2="149.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="34.5" y="144.7139">Submit add reivew form</text><line style="stroke:#A80036;stroke-width:1.0;" x1="380.5" x2="370.5" y1="179.9219" y2="175.9219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="380.5" x2="370.5" y1="179.9219" y2="183.9219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="190.5" x2="381.5" y1="179.9219" y2="179.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36" x="197.5" y="175.0654">POST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="237.5" y="175.0654">/AddReviewController</text><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="434.5" y1="210.2734" y2="210.2734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="434.5" x2="434.5" y1="210.2734" y2="223.2734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="393.5" x2="434.5" y1="223.2734" y2="223.2734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="393.5" x2="403.5" y1="223.2734" y2="219.2734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="393.5" x2="403.5" y1="223.2734" y2="227.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211" x="399.5" y="205.417">Context.lookup(String name): Object</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1130.5" x2="1120.5" y1="253.625" y2="249.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1130.5" x2="1120.5" y1="253.625" y2="257.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="1131.5" y1="253.625" y2="253.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="721" x="399.5" y="248.7686">protectedRouter(HttpServletRequest request, HttpServletResponse response, int minRole, int maxRole, String page): boolean</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1142.5" x2="1184.5" y1="283.9766" y2="283.9766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1184.5" x2="1184.5" y1="283.9766" y2="296.9766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1143.5" x2="1184.5" y1="296.9766" y2="296.9766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1143.5" x2="1153.5" y1="296.9766" y2="292.9766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1143.5" x2="1153.5" y1="296.9766" y2="300.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260" x="1149.5" y="279.1201">isLogin(HttpServletRequest request): boolean</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1142.5" x2="1184.5" y1="327.3281" y2="327.3281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1184.5" x2="1184.5" y1="327.3281" y2="340.3281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1143.5" x2="1184.5" y1="340.3281" y2="340.3281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1143.5" x2="1153.5" y1="340.3281" y2="336.3281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1143.5" x2="1153.5" y1="340.3281" y2="344.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="435" x="1149.5" y="322.4717">correctRole(HttpServletRequest request, int minRole, int maxRole): boolean</text><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="402.5" y1="370.6797" y2="366.6797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="402.5" y1="370.6797" y2="374.6797"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="392.5" x2="1136.5" y1="370.6797" y2="370.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="409.5" y="365.8232">Return result</text><path d="M101,385.6797 L162,385.6797 L162,393.6797 L152,403.6797 L101,403.6797 L101,385.6797 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="1120.1328" style="stroke:#000000;stroke-width:2.0;" width="2010.5" x="101" y="385.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="116" y="400.1748">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="125" x="177" y="399.0986">[action does not allow]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="190.5" x2="200.5" y1="426.3828" y2="422.3828"/><line style="stroke:#A80036;stroke-width:1.0;" x1="190.5" x2="200.5" y1="426.3828" y2="430.3828"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="190.5" x2="381.5" y1="426.3828" y2="426.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="207.5" y="421.5264">forward login.jsp</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="101" x2="2111.5" y1="435.3828" y2="435.3828"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="80" x="106" y="446.8018">[action allows]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="740.5" x2="730.5" y1="472.5703" y2="468.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="740.5" x2="730.5" y1="472.5703" y2="476.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="741.5" y1="472.5703" y2="472.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331" x="399.5" y="467.7139">doFilter(ServletRequest arg0, ServletResponse arg1): void</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1589.5" x2="1579.5" y1="502.9219" y2="498.9219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1589.5" x2="1579.5" y1="502.9219" y2="506.9219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="1590.5" y1="502.9219" y2="502.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="652" x="759.5" y="498.0654">getIntParams(HttpServletRequest request, String field, String label, int min, int max, Integer defaultValue): Integer</text><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="762.5" y1="533.2734" y2="529.2734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="762.5" y1="533.2734" y2="537.2734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="752.5" x2="1590.5" y1="533.2734" y2="533.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="769.5" y="528.417">Return roomId, rate</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1589.5" x2="1579.5" y1="563.625" y2="559.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1589.5" x2="1579.5" y1="563.625" y2="567.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="1590.5" y1="563.625" y2="563.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="655" x="759.5" y="558.7686">getStringParam(HttpServletRequest request, String field, String label, int min, int max, String defaultValue): String</text><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="762.5" y1="593.9766" y2="589.9766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="762.5" y1="593.9766" y2="597.9766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="752.5" x2="1595.5" y1="593.9766" y2="593.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="769.5" y="589.1201">Return message</text><path d="M111,608.9766 L172,608.9766 L172,616.9766 L162,626.9766 L111,626.9766 L111,608.9766 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="889.8359" style="stroke:#000000;stroke-width:2.0;" width="1990.5" x="111" y="608.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="126" y="623.4717">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="69" x="187" y="622.3955">[invalid data]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="402.5" y1="649.6797" y2="645.6797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="402.5" y1="649.6797" y2="653.6797"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="392.5" x2="741.5" y1="649.6797" y2="649.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="409.5" y="644.8232">forward ViewRoomController</text><line style="stroke:#A80036;stroke-width:1.0;" x1="190.5" x2="200.5" y1="680.0313" y2="676.0313"/><line style="stroke:#A80036;stroke-width:1.0;" x1="190.5" x2="200.5" y1="680.0313" y2="684.0313"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="190.5" x2="381.5" y1="680.0313" y2="680.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="207.5" y="675.1748">forward ViewRoomController</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="111" x2="2101.5" y1="689.0313" y2="689.0313"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="59" x="116" y="700.4502">[valid data]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="794.5" y1="726.2188" y2="726.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="794.5" x2="794.5" y1="726.2188" y2="739.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="753.5" x2="794.5" y1="739.2188" y2="739.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="753.5" x2="763.5" y1="739.2188" y2="735.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="753.5" x2="763.5" y1="739.2188" y2="743.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="318" x="759.5" y="721.3623">HttpSession.getAttribute(String arg0, Object arg1): void</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1681" x2="1671" y1="769.5703" y2="765.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1681" x2="1671" y1="769.5703" y2="773.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="1682" y1="769.5703" y2="769.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="282" x="759.5" y="764.7139">getOneUserByUsername(String username): User</text><line style="stroke:#A80036;stroke-width:1.0;" x1="2025" x2="2015" y1="799.9219" y2="795.9219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="2025" x2="2015" y1="799.9219" y2="803.9219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1693" x2="2026" y1="799.9219" y2="799.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="1700" y="795.0654">executeQuery(): ResultSet</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1693" x2="1703" y1="830.2734" y2="826.2734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1693" x2="1703" y1="830.2734" y2="834.2734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1693" x2="2031" y1="830.2734" y2="830.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="1710" y="825.417">Return ResultSet</text><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="762.5" y1="860.625" y2="856.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="762.5" y1="860.625" y2="864.625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="752.5" x2="1687" y1="860.625" y2="860.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="769.5" y="855.7686">Return User</text><path d="M121,875.625 L182,875.625 L182,883.625 L172,893.625 L121,893.625 L121,875.625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="616.1875" style="stroke:#000000;stroke-width:2.0;" width="1970.5" x="121" y="875.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="136" y="890.1201">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="116" x="197" y="889.0439">[user does not exist]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="402.5" y1="916.3281" y2="912.3281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="402.5" y1="916.3281" y2="920.3281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="392.5" x2="741.5" y1="916.3281" y2="916.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="409.5" y="911.4717">forward ViewRoomController</text><line style="stroke:#A80036;stroke-width:1.0;" x1="190.5" x2="200.5" y1="946.6797" y2="942.6797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="190.5" x2="200.5" y1="946.6797" y2="950.6797"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="190.5" x2="381.5" y1="946.6797" y2="946.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="207.5" y="941.8232">forward ViewRoomController</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="121" x2="2091.5" y1="955.6797" y2="955.6797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="71" x="126" y="967.0986">[user exists]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1776" x2="1766" y1="992.8672" y2="988.8672"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1776" x2="1766" y1="992.8672" y2="996.8672"/><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="1777" y1="992.8672" y2="992.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="759.5" y="988.0107">getRoomById(int roomId): Room</text><line style="stroke:#A80036;stroke-width:1.0;" x1="2025" x2="2015" y1="1023.2188" y2="1019.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="2025" x2="2015" y1="1023.2188" y2="1027.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1788" x2="2026" y1="1023.2188" y2="1023.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="1795" y="1018.3623">executeQuery(): ResultSet</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1788" x2="1798" y1="1053.5703" y2="1049.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1788" x2="1798" y1="1053.5703" y2="1057.5703"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1788" x2="2031" y1="1053.5703" y2="1053.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="1805" y="1048.7139">Return ResultSet</text><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="762.5" y1="1083.9219" y2="1079.9219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="762.5" y1="1083.9219" y2="1087.9219"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="752.5" x2="1782" y1="1083.9219" y2="1083.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="769.5" y="1079.0654">Return Room</text><path d="M131,1098.9219 L192,1098.9219 L192,1106.9219 L182,1116.9219 L131,1116.9219 L131,1098.9219 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="385.8906" style="stroke:#000000;stroke-width:2.0;" width="1950.5" x="131" y="1098.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="146" y="1113.417">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="120" x="207" y="1112.3408">[room does not exist]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="402.5" y1="1139.625" y2="1135.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="402.5" y1="1139.625" y2="1143.625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="392.5" x2="741.5" y1="1139.625" y2="1139.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="409.5" y="1134.7686">forward ViewRoomController</text><line style="stroke:#A80036;stroke-width:1.0;" x1="190.5" x2="200.5" y1="1169.9766" y2="1165.9766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="190.5" x2="200.5" y1="1169.9766" y2="1173.9766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="190.5" x2="381.5" y1="1169.9766" y2="1169.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="207.5" y="1165.1201">forward ViewRoomController</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131" x2="2081.5" y1="1178.9766" y2="1178.9766"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="75" x="136" y="1190.3955">[room exists]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1879" x2="1869" y1="1216.1641" y2="1212.1641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1879" x2="1869" y1="1216.1641" y2="1220.1641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="1880" y1="1216.1641" y2="1216.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="759.5" y="1211.3076">addReview(Review review): boolean</text><line style="stroke:#A80036;stroke-width:1.0;" x1="2025" x2="2015" y1="1246.5156" y2="1242.5156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="2025" x2="2015" y1="1246.5156" y2="1250.5156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1891" x2="2026" y1="1246.5156" y2="1246.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="1898" y="1241.6592">executeUpdate(): int</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1891" x2="1901" y1="1276.8672" y2="1272.8672"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1891" x2="1901" y1="1276.8672" y2="1280.8672"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1891" x2="2031" y1="1276.8672" y2="1276.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="1908" y="1272.0107">Return result</text><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="762.5" y1="1307.2188" y2="1303.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="752.5" x2="762.5" y1="1307.2188" y2="1311.2188"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="752.5" x2="1885" y1="1307.2188" y2="1307.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="769.5" y="1302.3623">Return result</text><path d="M141,1322.2188 L202,1322.2188 L202,1330.2188 L192,1340.2188 L141,1340.2188 L141,1322.2188 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="155.5938" style="stroke:#000000;stroke-width:2.0;" width="693.5" x="141" y="1322.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="156" y="1336.7139">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="35" x="217" y="1335.6377">[false]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="402.5" y1="1362.9219" y2="1358.9219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="402.5" y1="1362.9219" y2="1366.9219"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="392.5" x2="741.5" y1="1362.9219" y2="1362.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="409.5" y="1358.0654">forward ViewRoomController</text><line style="stroke:#A80036;stroke-width:1.0;" x1="190.5" x2="200.5" y1="1393.2734" y2="1389.2734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="190.5" x2="200.5" y1="1393.2734" y2="1397.2734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="190.5" x2="381.5" y1="1393.2734" y2="1393.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="207.5" y="1388.417">forward ViewRoomController</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="141" x2="834.5" y1="1402.2734" y2="1402.2734"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="31" x="146" y="1413.6924">[true]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="402.5" y1="1439.4609" y2="1435.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="392.5" x2="402.5" y1="1439.4609" y2="1443.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="392.5" x2="746.5" y1="1439.4609" y2="1439.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="409.5" y="1434.6045">redirect /ViewRoomController</text><line style="stroke:#A80036;stroke-width:1.0;" x1="185.5" x2="195.5" y1="1469.8125" y2="1465.8125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="185.5" x2="195.5" y1="1469.8125" y2="1473.8125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="185.5" x2="386.5" y1="1469.8125" y2="1469.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="202.5" y="1464.9561">redirect /ViewRoomController</text><!--MD5=[c236abed438b7d3491d63dca9474277b]
@startuml
mainframe **sd** Add Review Controller
hide footbox
actor User
participant "Browser" as Browser
participant "CustomerFilter" as CustomerFilter
participant ":AddReviewController" as AddReviewController
participant "Helper" as Helper
participant "GetParam" as GetParam
participant ":UserDAO" as UserDAO
participant ":RoomDAO" as RoomDAO
participant ":ReviewDAO" as ReviewDAO
participant "Database" as Database

User ->> Browser: Submit add reivew form
activate Browser
Browser ->> CustomerFilter: **POST** /AddReviewController
activate CustomerFilter
CustomerFilter ->> CustomerFilter: Context.lookup(String name): Object
CustomerFilter ->> Helper: protectedRouter(HttpServletRequest request, HttpServletResponse response, int minRole, int maxRole, String page): boolean
activate Helper
Helper ->> Helper: isLogin(HttpServletRequest request): boolean
Helper ->> Helper: correctRole(HttpServletRequest request, int minRole, int maxRole): boolean
Helper - ->> CustomerFilter: Return result
deactivate Helper

alt action does not allow
    CustomerFilter - ->> Browser: forward login.jsp

else action allows
    CustomerFilter ->> AddReviewController: doFilter(ServletRequest arg0, ServletResponse arg1): void
    activate AddReviewController
    AddReviewController ->> GetParam: getIntParams(HttpServletRequest request, String field, String label, int min, int max, Integer defaultValue): Integer
    activate GetParam
    GetParam - ->> AddReviewController: Return roomId, rate
    AddReviewController ->> GetParam: getStringParam(HttpServletRequest request, String field, String label, int min, int max, String defaultValue): String
    GetParam - ->> AddReviewController: Return message
    deactivate GetParam
    alt invalid data
        AddReviewController - ->> CustomerFilter: forward ViewRoomController
        CustomerFilter - ->> Browser: forward ViewRoomController
    else valid data
        AddReviewController ->> AddReviewController: HttpSession.getAttribute(String arg0, Object arg1): void
        AddReviewController ->> UserDAO: getOneUserByUsername(String username): User
        activate UserDAO
        UserDAO ->> Database: executeQuery(): ResultSet
        activate Database
        Database - ->> UserDAO: Return ResultSet
        deactivate Database
        UserDAO - ->> AddReviewController: Return User
        deactivate UserDAO

        alt user does not exist
            AddReviewController - ->> CustomerFilter: forward ViewRoomController
            CustomerFilter - ->> Browser: forward ViewRoomController
        else user exists
            AddReviewController ->> RoomDAO: getRoomById(int roomId): Room
            activate RoomDAO
            RoomDAO ->> Database: executeQuery(): ResultSet
            activate Database
            Database - ->> RoomDAO: Return ResultSet
            deactivate Database
            RoomDAO - ->> AddReviewController: Return Room
            deactivate RoomDAO

            alt room does not exist
                AddReviewController - ->> CustomerFilter: forward ViewRoomController
                CustomerFilter - ->> Browser: forward ViewRoomController
            else room exists
                AddReviewController ->> ReviewDAO: addReview(Review review): boolean
                activate ReviewDAO
                ReviewDAO ->> Database: executeUpdate(): int
                activate Database
                Database - ->> ReviewDAO: Return result
                deactivate Database
                ReviewDAO - ->> AddReviewController: Return result
                deactivate ReviewDAO

                alt false
                    AddReviewController - ->> CustomerFilter: forward ViewRoomController
                    CustomerFilter - ->> Browser: forward ViewRoomController
        
                else true
                    AddReviewController - ->> CustomerFilter: redirect /ViewRoomController
                    deactivate AddReviewController
                    CustomerFilter - ->> Browser: redirect /ViewRoomController
                    deactivate Browser
                    deactivate CustomerFilter
                end
            end
        end
    end
end


@enduml

PlantUML version 1.2021.7(Sun May 23 19:40:07 ICT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>